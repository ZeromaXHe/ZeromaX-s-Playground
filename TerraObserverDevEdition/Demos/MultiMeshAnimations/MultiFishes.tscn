[gd_scene load_steps=6 format=3 uid="uid://5eqki7gf0v0t"]

[ext_resource type="BoxMesh" uid="uid://c45een5l4gxi7" path="res://Demos/MultiMeshAnimations/Fish.tres" id="1_gvayb"]
[ext_resource type="Shader" uid="uid://khf3272xkmnj" path="res://Demos/MultiMeshAnimations/ParticleFish.gdshader" id="2_7ahj2"]

[sub_resource type="MultiMesh" id="MultiMesh_7ahj2"]
transform_format = 1
use_custom_data = true
instance_count = 100
mesh = ExtResource("1_gvayb")
buffer = PackedFloat32Array(1, 0, 0, -39.571, 0, 1, 0, 4.54918, 0, 0, 1, 23.2813, 0.0533803, 0.682975, 0.422379, 0.660657, 1, 0, 0, -16.451, 0, 1, 0, 4.80229, 0, 0, 1, 22.5459, 0.861102, 0.78495, 0.819966, 0.147613, 1, 0, 0, -33.6381, 0, 1, 0, -12.8018, 0, 0, 1, -13.8564, 0.383606, 0.583517, 0.0707305, 0.150563, 1, 0, 0, -19.9483, 0, 1, 0, 1.59988, 0, 0, 1, -23.3034, 0.119626, 0.429593, 0.975626, 0.221358, 1, 0, 0, 49.5517, 0, 1, 0, -18.8924, 0, 0, 1, 8.15603, 0.898804, 0.192144, 0.0753678, 0.366178, 1, 0, 0, 14.5616, 0, 1, 0, 20.2594, 0, 0, 1, 7.42928, 0.300446, 0.953154, 0.450064, 0.137208, 1, 0, 0, 3.92632, 0, 1, 0, -24.8011, 0, 0, 1, 11.9394, 0.0173857, 0.967631, 0.37709, 0.353809, 1, 0, 0, 49.8283, 0, 1, 0, -24.2741, 0, 0, 1, -3.96121, 0.685261, 0.369537, 0.282384, 0.916039, 1, 0, 0, -12.6352, 0, 1, 0, -1.98328, 0, 0, 1, 15.0352, 0.500054, 0.233211, 0.715768, 0.484939, 1, 0, 0, 31.5162, 0, 1, 0, 11.3856, 0, 0, 1, 23.0253, 0.972052, 0.639685, 0.696183, 0.37348, 1, 0, 0, -46.5425, 0, 1, 0, 17.3055, 0, 0, 1, 24.1539, 0.622799, 0.600494, 0.919769, 0.623834, 1, 0, 0, 12.0154, 0, 1, 0, -14.5776, 0, 0, 1, -7.03591, 0.321722, 0.988775, 0.886385, 0.0851687, 1, 0, 0, 37.3047, 0, 1, 0, 15.5486, 0, 0, 1, 4.63956, 0.930806, 0.837349, 0.0844461, 0.294865, 1, 0, 0, -37.8035, 0, 1, 0, 21.8407, 0, 0, 1, 13.9596, 0.793367, 0.899577, 0.838507, 0.948725, 1, 0, 0, -45.6987, 0, 1, 0, -21.8275, 0, 0, 1, 16.2032, 0.0447177, 0.922574, 0.31957, 0.708446, 1, 0, 0, 47.8396, 0, 1, 0, 10.5451, 0, 0, 1, 4.64256, 0.204813, 0.660557, 0.62521, 0.46543, 1, 0, 0, 3.09346, 0, 1, 0, 19.0303, 0, 0, 1, -19.7435, 0.583547, 0.932154, 0.51313, 0.828284, 1, 0, 0, 19.3346, 0, 1, 0, 10.6431, 0, 0, 1, 23.2505, 0.12066, 0.220454, 0.476621, 0.809951, 1, 0, 0, -25.9951, 0, 1, 0, -24.9459, 0, 0, 1, -11.5748, 0.317683, 0.923022, 0.526476, 0.588647, 1, 0, 0, 29.5419, 0, 1, 0, 7.25233, 0, 0, 1, 4.19994, 0.576835, 0.369876, 0.945985, 0.232427, 1, 0, 0, -22.0754, 0, 1, 0, -13.0864, 0, 0, 1, -8.47265, 0.222367, 0.999042, 0.799513, 0.836046, 1, 0, 0, -34.3147, 0, 1, 0, 7.47466, 0, 0, 1, 24.6107, 0.0677028, 0.559919, 0.582608, 0.913863, 1, 0, 0, 27.6731, 0, 1, 0, -3.09359, 0, 0, 1, -3.13749, 0.299409, 0.701076, 0.928602, 0.380583, 1, 0, 0, -41.0786, 0, 1, 0, -3.36837, 0, 0, 1, -9.35617, 0.650006, 0.0319461, 0.440813, 0.791931, 1, 0, 0, 23.012, 0, 1, 0, -10.2893, 0, 0, 1, 23.6004, 0.879666, 0.866123, 0.117129, 0.000980131, 1, 0, 0, 6.69456, 0, 1, 0, 15.3531, 0, 0, 1, 0.231153, 0.644181, 0.524272, 0.554075, 0.480693, 1, 0, 0, 41.0899, 0, 1, 0, -19.3569, 0, 0, 1, -19.7876, 0.818237, 0.765489, 0.831077, 0.563767, 1, 0, 0, -4.80069, 0, 1, 0, -7.99465, 0, 0, 1, 19.6583, 0.949078, 0.233685, 0.445644, 0.864929, 1, 0, 0, -18.6662, 0, 1, 0, 22.1446, 0, 0, 1, -13.4671, 0.200593, 0.791966, 0.0919644, 0.881689, 1, 0, 0, 43.0138, 0, 1, 0, -9.66331, 0, 0, 1, 20.2949, 0.542611, 0.216355, 0.765035, 0.787781, 1, 0, 0, 8.51753, 0, 1, 0, 14.8069, 0, 0, 1, -0.184064, 0.784987, 0.982537, 0.497075, 0.681819, 1, 0, 0, -44.1752, 0, 1, 0, 7.7815, 0, 0, 1, 8.38876, 0.306004, 0.0924311, 0.449654, 0.0631556, 1, 0, 0, 10.983, 0, 1, 0, 23.9109, 0, 0, 1, 17.1628, 0.469924, 0.0578312, 0.29173, 0.582927, 1, 0, 0, 32.7776, 0, 1, 0, 17.0719, 0, 0, 1, -8.97246, 0.287036, 0.996918, 0.440656, 0.961064, 1, 0, 0, -45.6635, 0, 1, 0, -18.9964, 0, 0, 1, -14.0265, 0.63169, 0.677246, 0.0230888, 0.456148, 1, 0, 0, 44.4485, 0, 1, 0, 24.4174, 0, 0, 1, -19.2152, 0.175384, 0.00135312, 0.364338, 0.365843, 1, 0, 0, 29.5191, 0, 1, 0, 8.31752, 0, 0, 1, -9.25921, 0.875394, 0.671496, 0.329748, 0.416147, 1, 0, 0, 29.3172, 0, 1, 0, -23.05, 0, 0, 1, -12.1065, 0.639717, 0.534478, 0.431308, 0.00578584, 1, 0, 0, -38.646, 0, 1, 0, 2.2296, 0, 0, 1, 4.8821, 0.668819, 0.34519, 0.238095, 0.790169, 1, 0, 0, 16.9242, 0, 1, 0, 11.7156, 0, 0, 1, -8.00262, 0.177907, 0.383177, 0.114178, 0.0241057, 1, 0, 0, -11.6893, 0, 1, 0, 19.3757, 0, 0, 1, 20.4442, 0.179212, 0.438565, 0.431835, 0.390043, 1, 0, 0, -13.3238, 0, 1, 0, 14.0503, 0, 0, 1, -3.53452, 0.933117, 0.18924, 0.678806, 0.323809, 1, 0, 0, -9.15527, 0, 1, 0, -13.6433, 0, 0, 1, 17.1416, 0.423272, 0.446166, 0.0546012, 0.574856, 1, 0, 0, 5.52164, 0, 1, 0, 20.1569, 0, 0, 1, -3.60682, 0.0763474, 0.269658, 0.383141, 0.0779658, 1, 0, 0, 19.7455, 0, 1, 0, -1.19262, 0, 0, 1, -5.54738, 0.103906, 0.426144, 0.10118, 0.0226507, 1, 0, 0, -23.8427, 0, 1, 0, -4.6637, 0, 0, 1, 17.1149, 0.642664, 0.913367, 0.697841, 0.214076, 1, 0, 0, -19.3648, 0, 1, 0, 2.46373, 0, 0, 1, -15.3899, 0.926988, 0.0469025, 0.242611, 0.617168, 1, 0, 0, -46.6082, 0, 1, 0, 23.367, 0, 0, 1, -3.22724, 0.869677, 0.197481, 0.550025, 0.973647, 1, 0, 0, 6.05716, 0, 1, 0, 17.9913, 0, 0, 1, 8.86054, 0.408424, 0.386816, 0.0626619, 0.279081, 1, 0, 0, -20.2798, 0, 1, 0, -0.645189, 0, 0, 1, -19.7086, 0.612996, 0.762681, 0.536023, 0.00315249, 1, 0, 0, -7.68955, 0, 1, 0, -7.27267, 0, 0, 1, -17.8099, 0.735954, 0.348908, 0.955699, 0.333658, 1, 0, 0, -29.6084, 0, 1, 0, 23.5567, 0, 0, 1, 0.433552, 0.211374, 0.759729, 0.286588, 0.648669, 1, 0, 0, -31.7928, 0, 1, 0, 11.2926, 0, 0, 1, -19.5866, 0.932207, 0.0577951, 0.110512, 0.285591, 1, 0, 0, -43.3932, 0, 1, 0, -3.91994, 0, 0, 1, -14.7201, 0.317168, 0.801124, 0.62152, 0.489365, 1, 0, 0, -39.419, 0, 1, 0, -2.09091, 0, 0, 1, -15.9956, 0.620292, 0.493783, 0.28427, 0.852053, 1, 0, 0, 11.2471, 0, 1, 0, 17.399, 0, 0, 1, -15.7192, 0.71996, 0.0578163, 0.323927, 0.035938, 1, 0, 0, -4.66452, 0, 1, 0, -21.8046, 0, 0, 1, -14.5351, 0.519651, 0.944269, 0.464015, 0.0251582, 1, 0, 0, 28.05, 0, 1, 0, -11.3858, 0, 0, 1, -0.0795051, 0.168247, 0.575959, 0.351106, 0.18782, 1, 0, 0, 39.7881, 0, 1, 0, 24.6687, 0, 0, 1, 16.5976, 0.419589, 0.292723, 0.036085, 0.509428, 1, 0, 0, -27.6516, 0, 1, 0, -24.308, 0, 0, 1, -10.5616, 0.11877, 0.772936, 0.884548, 0.520629, 1, 0, 0, -40.7274, 0, 1, 0, -5.62143, 0, 0, 1, -7.12218, 0.476062, 0.902356, 0.407682, 0.807482, 1, 0, 0, 35.1207, 0, 1, 0, 7.38045, 0, 0, 1, -3.24794, 0.278344, 0.38641, 0.949891, 0.450238, 1, 0, 0, 10.2679, 0, 1, 0, 18.3317, 0, 0, 1, -8.07586, 0.389386, 0.796314, 0.364126, 0.485696, 1, 0, 0, 43.5896, 0, 1, 0, 23.6995, 0, 0, 1, -3.16463, 0.470487, 0.107762, 0.461335, 0.33423, 1, 0, 0, 31.0915, 0, 1, 0, -12.4854, 0, 0, 1, 5.0235, 0.321341, 0.890327, 0.242594, 0.0336445, 1, 0, 0, 8.6102, 0, 1, 0, 6.08065, 0, 0, 1, -22.869, 0.714892, 0.197805, 0.590287, 0.146563, 1, 0, 0, 30.6114, 0, 1, 0, -2.77234, 0, 0, 1, -7.86383, 0.940824, 0.0652002, 0.583891, 0.20069, 1, 0, 0, -28.6214, 0, 1, 0, -10.84, 0, 0, 1, -14.5899, 0.550778, 0.488633, 0.479169, 0.954686, 1, 0, 0, -37.5844, 0, 1, 0, -15.3279, 0, 0, 1, -24.9792, 0.451826, 0.462136, 0.821915, 0.440518, 1, 0, 0, -6.61681, 0, 1, 0, -7.20606, 0, 0, 1, -10.5597, 0.319112, 0.864461, 0.451513, 0.580461, 1, 0, 0, 2.52434, 0, 1, 0, -3.03084, 0, 0, 1, 7.91309, 0.651004, 0.886751, 0.191699, 0.123126, 1, 0, 0, -36.5191, 0, 1, 0, -7.24181, 0, 0, 1, 13.5354, 0.0887018, 0.591807, 0.571593, 0.00561949, 1, 0, 0, 7.57653, 0, 1, 0, 12.8244, 0, 0, 1, -7.92288, 0.269399, 0.43437, 0.733808, 0.626512, 1, 0, 0, -18.4517, 0, 1, 0, 20.7533, 0, 0, 1, -16.6386, 0.630739, 0.270598, 0.220398, 0.843698, 1, 0, 0, 7.60713, 0, 1, 0, -2.0482, 0, 0, 1, 24.8823, 0.865937, 0.875077, 0.458295, 0.0310966, 1, 0, 0, 46.6627, 0, 1, 0, 6.41814, 0, 0, 1, -18.4853, 0.265528, 0.141884, 0.0396989, 0.273687, 1, 0, 0, -40.5843, 0, 1, 0, -21.6016, 0, 0, 1, 22.9235, 0.488752, 0.38243, 0.691417, 0.935126, 1, 0, 0, 48.663, 0, 1, 0, -5.04854, 0, 0, 1, -21.9565, 0.63296, 0.95487, 0.534556, 0.83314, 1, 0, 0, -3.61766, 0, 1, 0, -14.6427, 0, 0, 1, -9.14849, 0.967583, 0.2121, 0.987792, 0.303355, 1, 0, 0, 32.8381, 0, 1, 0, -9.71117, 0, 0, 1, 6.91774, 0.914821, 0.991081, 0.305042, 0.847331, 1, 0, 0, 28.7392, 0, 1, 0, -9.15956, 0, 0, 1, -12.5874, 0.467707, 0.243858, 0.398067, 0.929675, 1, 0, 0, 19.1211, 0, 1, 0, 16.0762, 0, 0, 1, 24.318, 0.295453, 0.319171, 0.13249, 0.296756, 1, 0, 0, 17.7729, 0, 1, 0, -5.50337, 0, 0, 1, 3.89813, 0.114357, 0.581791, 0.916479, 0.68007, 1, 0, 0, 16.3301, 0, 1, 0, 11.4484, 0, 0, 1, -5.59422, 0.878479, 0.124725, 0.333726, 0.207471, 1, 0, 0, 27.5637, 0, 1, 0, 10.7186, 0, 0, 1, 17.3358, 0.779256, 0.255355, 0.535153, 0.12445, 1, 0, 0, -24.7573, 0, 1, 0, 10.5383, 0, 0, 1, -13.0483, 0.472716, 0.59905, 0.294785, 0.564936, 1, 0, 0, -33.4806, 0, 1, 0, 11.7712, 0, 0, 1, 13.5965, 0.454231, 0.522405, 0.142392, 0.521459, 1, 0, 0, 14.9678, 0, 1, 0, 24.3925, 0, 0, 1, 18.5741, 0.509976, 0.0136813, 0.839165, 0.330218, 1, 0, 0, -4.25734, 0, 1, 0, 13.9693, 0, 0, 1, 20.3915, 0.0480309, 0.646392, 0.753607, 0.611391, 1, 0, 0, -42.5275, 0, 1, 0, 15.2944, 0, 0, 1, -22.7128, 0.477202, 0.346448, 0.888537, 0.164326, 1, 0, 0, -29.9871, 0, 1, 0, 13.9032, 0, 0, 1, 6.51771, 0.347332, 0.740538, 0.410471, 0.393815, 1, 0, 0, 24.5612, 0, 1, 0, -23.249, 0, 0, 1, -1.10607, 0.585602, 0.933606, 0.267961, 0.883187, 1, 0, 0, 16.6156, 0, 1, 0, -21.653, 0, 0, 1, -5.26985, 0.179226, 0.893909, 0.568227, 0.257139, 1, 0, 0, -21.0313, 0, 1, 0, -9.68045, 0, 0, 1, -5.95839, 0.82757, 0.352676, 0.0291375, 0.333591, 1, 0, 0, -0.777721, 0, 1, 0, -14.2435, 0, 0, 1, 13.983, 0.155805, 0.977003, 0.580001, 0.5477, 1, 0, 0, 1.69336, 0, 1, 0, 19.3116, 0, 0, 1, 5.75408, 0.706457, 0.0640564, 0.600297, 0.549003, 1, 0, 0, -34.4456, 0, 1, 0, 8.65113, 0, 0, 1, 9.00423, 0.548529, 0.488845, 0.887992, 0.363972, 1, 0, 0, 21.9087, 0, 1, 0, -13.8288, 0, 0, 1, -16.2024, 0.754629, 0.317669, 0.429008, 0.641833, 1, 0, 0, -40.186, 0, 1, 0, -24.5556, 0, 0, 1, 12.8575, 0.376261, 0.494127, 0.506425, 0.957395, 1, 0, 0, -24.8539, 0, 1, 0, 1.59232, 0, 0, 1, 19.3275, 0.727259, 0.369026, 0.620149, 0.812342)

[sub_resource type="GDScript" id="GDScript_ap35s"]
script/source = "@tool
extends MultiMeshInstance3D

func _ready() -> void:
	self.multimesh.instance_count = 100
	for i in range(self.multimesh.instance_count):
		var position = Transform3D()
		position = position.translated(Vector3(randf() * 100 - 50, randf() * 50 - 25, randf() * 50 - 25))
		self.multimesh.set_instance_transform(i, position)
		self.multimesh.set_instance_custom_data(i, Color(randf(), randf(), randf(), randf()))
"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ap35s"]
shader = ExtResource("2_7ahj2")

[node name="MultiFishes" type="MultiMeshInstance3D"]
multimesh = SubResource("MultiMesh_7ahj2")
script = SubResource("GDScript_ap35s")

[node name="ParticleFishes" type="GPUParticles3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 25, 0)
amount = 100
process_material = SubResource("ShaderMaterial_ap35s")
draw_pass_1 = ExtResource("1_gvayb")
